import dataCiteToRecord from '../utils/dataCiteToRecord';

const res = {
    "data": {
        "id": "10.5061/dryad.x69p8czn0",
        "type": "dois",
        "attributes": {
            "doi": "10.5061/dryad.x69p8czn0",
            "prefix": "10.5061",
            "suffix": "dryad.x69p8czn0",
            "identifiers": [],
            "alternateIdentifiers": [],
            "creators": [],
            "titles": [
                {
                    "title": "Data for: Dynamic coastal pelagic habitat drives rapid changes in growth and condition of juvenile sockeye salmon (Oncorhynchus nerka) during early marine migration"
                }
            ],
            "publisher": "Dryad",
            "container": {},
            "publicationYear": 2022,
            "subjects": [],
            "contributors": [
                {
                    "name": "Hakai Institute",
                    "affiliation": [],
                    "contributorType": "Sponsor",
                    "nameIdentifiers": [],
                }
            ],
            "dates": [
                {
                    "date": "2022-11-09T00:00:00Z",
                    "dateType": "Issued",
                },
                {
                    "date": "2022-11-09T00:00:00Z",
                    "dateType": "Available",
                }
            ],
            "language": "en",
            "types": {
                "ris": "DATA",
                "bibtex": "misc",
                "citeproc": "dataset",
                "schemaOrg": "Dataset",
                "resourceType": "dataset",
                "resourceTypeGeneral": "Dataset",
            },
            "relatedIdentifiers": [
                {
                    "relationType": "IsCitedBy",
                    "relatedIdentifier": "10.1101/2022.03.21.484660",
                    "relatedIdentifierType": "DOI",
                },
                {
                    "relationType": "IsSupplementedBy",
                    "relatedIdentifier": "10.21966/1.566666",
                    "relatedIdentifierType": "DOI",
                },
                {
                    "relationType": "IsCitedBy",
                    "relatedIdentifier": "10.1139/facets-2022-0068",
                    "relatedIdentifierType": "DOI",
                },
            ],
            "relatedItems": [],
            "sizes": [
                "313940 bytes",
            ],
            "formats": [],
            "version": "3",
            "rightsList": [
                {
                    "rights": "Creative Commons Zero v1.0 Universal",
                    "rightsUri": "https://creativecommons.org/publicdomain/zero/1.0/legalcode",
                    "schemeUri": "https://spdx.org/licenses/",
                    "rightsIdentifier": "cc0-1.0",
                    "rightsIdentifierScheme": "SPDX",
                },
            ],
            "descriptions": [
                {
                    "description": "Migrating marine taxa encounter diverse habitats that differ\n environmentally and in foraging conditions over a range of spatial scales.\n We examined body (RNA/DNA, length-weight residuals) and nutritional (fatty\n acid composition) condition of juvenile sockeye salmon (Oncorhynchus\n nerka) in British Columbia while migrating through oceanographically\n variable waters. Fish were sampled in the stratified northern Strait of\n Georgia (NSoG); the highly mixed Johnstone Strait (JS); and the\n transitional zone of Queen Charlotte Strait (QCS). In 2015, body and\n nutritional condition were high in the NSoG but rapidly declined to reach\n the lowest levels in JS where prey availability was low, before showing\n signs of compensatory growth in QCS. In 2016, juvenile salmon had a\n significantly lower condition in the NSoG than in 2015, although\n zooplankton biomass was similar, condition remained low in JS, and no\n compensatory growth was observed in QCS. We provide evidence that\n differences in juvenile salmon condition between the two years were due to\n changes in the food quality available to juvenile fish. We propose that\n existing hypotheses about fish survival need to be extended to incorporate\n food quality in addition to quantity to understand changes in fish\n condition and survival between years.",
                    "descriptionType": "Abstract",
                },
                {
                    "description": "Zooplankton was collected using a vertical Bong net (250 µm mesh size,\n mouth diameter 0.5 m). The net was deployed from near-bottom depth at a\n maximum of 300 m depth to surface. Zooplankton was preserved in 5%\n buffered formaldehyde-seawater solution. Zooplankton was identified to the\n lower taxonomic level possible. For detailed methods, see the associated\n article. Fish were collected from a 6m motorized vessel at distances of\n 5-60m from shore, using a purse seine designed for manual deployment and\n retrieval (bunt: 27 x 9 m with 13 mm mesh; tow 46 x 9 m 76 mm mesh). White\n muscle tissues were collected post-catchment from flash-frozen organisms.\n RNA:DNA ratios were measured at the University of British Columbia (UBC)\n using a VarioSkan Flash Microplate Reader (ThermoFisher Scientific). For\n detailed methods see Garzke et al (2022). RNA:DNA ratios were measured in\n triplicates and sample averages were calculated from triplicates not\n exceeding a coefficient of variance above 15%. Fatty acids follow the\n notation C20:5n.3 corresponding to eicosapentaenoic acid (EPA), where 20\n is the number of carbon atoms, 5 is the number of double bonds, and 3 is\n the position of the first double bond from the omega end. Fatty acids were\n analyzed at the Fisheries and Oceans Canada (DFO) Pacific Science\n Enterprise Centre. FAs were converted to fatty acid methyl esters using a\n direct transesterification method, separated using an Agilent CP-Sil 88\n column (50 m, 0.25 mm diameter), and quantified with a gas chromatograph\n (SCION 436) equipped with a flame ionization detector. These data\n represent all chromatogram peaks attributed to FAs based on external\n standards (Nu-Chek Prep GLC-37, GLC-463; Cayman Chemical 18:4n-3; Matreya\n PUFA Mix No. 3) and by comparing reference samples analyzed at another lab\n (M.T. Brett, University of Washington). Overall, 81.2 ± 0.08% (mean ± sd)\n of the chromatogram area was identified and attributed to FAs. FAs were\n quantified based on a known quantity of an internal standard, C19:0, that\n was added to each sample. For detailed methods see Garzke et al (2022).\n For each sampling date, fatty acids are presented as μg of total fatty\n acids of mg DW of the analysed muscle tissue. Oceanography data (SST and\n SSS), were collected from CTD profiles using a RBR maestro and SeaBird\n 19plus V2 CTD. Samples represent the average of the upper 10m of the water\n column.",
                    "descriptionType": "Methods",
                },
                {
                    "description": "No proprietary programs required to use these data. ",
                    "descriptionType": "Other",
                },
            ],
            "geoLocations": [
                {
                    "geoLocationBox": {
                        "eastBoundLongitude": -124.67574133,
                        "northBoundLatitude": 50.73488305,
                        "southBoundLatitude": 49.89790212,
                        "westBoundLongitude": -126.8232006,
                    },
                },
            ],
            "fundingReferences": [
                {
                    "schemeUri": "https://ror.org",
                    "funderName": "Tula Foundation",
                    "funderIdentifier": "https://ror.org/0029jxk29",
                    "funderIdentifierType": "ROR",
                },
                {
                    "schemeUri": "https://ror.org",
                    "funderName": "Natural Sciences and Engineering Research Council",
                    "awardNumber": "RGPIN-2017-04499",
                    "funderIdentifier": "https://ror.org/01h531d29",
                    "funderIdentifierType": "ROR",
                },
                {
                    "schemeUri": "https://ror.org",
                    "funderName": "Mitacs",
                    "awardNumber": "IT09911",
                    "funderIdentifier": "https://ror.org/00cjrc276",
                    "funderIdentifierType": "ROR",
                },
                {
                    "schemeUri": "https://ror.org",
                    "funderName": "Mitacs",
                    "awardNumber": "IT13677",
                    "funderIdentifier": "https://ror.org/00cjrc276",
                    "funderIdentifierType": "ROR",
                },
            ],
            "url": "https://datadryad.org/stash/dataset/doi:10.5061/dryad.x69p8czn0",
            "contentUrl": null,
            "metadataVersion": 3,
            "schemaVersion": "http://datacite.org/schema/kernel-4",
            "source": "mds",
            "isActive": true,
            "state": "findable",
            "reason": null,
            "viewCount": 150,
            "viewsOverTime": [],
            "downloadCount": 3,
            "downloadsOverTime": [],
            "referenceCount": 1,
            "citationCount": 3,
            "citationsOverTime": [],
            "partCount": 0,
            "partOfCount": 0,
            "versionCount": 0,
            "versionOfCount": 0,
            "created": "2022-11-09T23:56:15.000Z",
            "registered": "2022-11-09T23:56:16.000Z",
            "published": "2022",
            "updated": "2024-04-11T06:06:58.000Z",
        },
        "relationships": {
            "client": {},
            "provider": {},
            "media": {},
            "references": {},
            "citations": {
                "data": [
                    {
                        "id": "10.48321/d1cw23",
                        "type": "dois",
                    },
                    {
                        "id": "10.1101/2022.03.21.484660",
                        "type": "dois",
                    },
                    {
                        "id": "10.1139/facets-2022-0068",
                        "type": "dois",
                    },
                ],
            },
            "parts": {
                "data": [],
            },
            "partOf": {
                "data": [],
            },
            "versions": {
                "data": [],
            },
            "versionOf": {
                "data": [],
            },
        },
    },
};

describe('DataCite to Firbase Record', () => {
    beforeEach(() => {
        // Reset the database before each test
        jest.clearAllMocks();
    });

    it('should convert dataCite json to record', async () => {
        const record = await dataCiteToRecord(res.data.attributes);
        console.log(JSON.stringify(record, 0, 2));
        expect(record).toBeDefined();

    });

});